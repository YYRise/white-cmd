# white-cmd: 安全的Shell命令白名单验证工具

## 项目简介
white-cmd 是一个通过**白名单机制**严格限制可执行Shell命令及其参数的安全工具，致力于解决以下痛点：
- 防止非法命令执行（如恶意脚本、未授权工具调用）
- 限制误操作风险（如误删文件、错误参数执行）
- 规范运维操作（标准化命令执行流程）

核心功能覆盖命令合法性验证全流程：
- **命令级白名单**：仅允许配置的命令执行（如`ls`/`docker`等）
- **参数级校验**：细粒度控制参数（支持禁止参数/允许任意参数/限制特定参数组合）
- **复杂语法解析**：精准解析引号（`"双引号"`/`'单引号'`）、转义符（`\`）、反引号替换（`` `date` ``）等复杂Shell语法
- **跨平台适配**：自动识别Linux（`/bin/sh`）与Windows（`cmd.exe`）执行环境

---

## 功能特性
| 特性                | 说明                                                                 |
|---------------------|----------------------------------------------------------------------|
| 白名单验证          | 通过YAML配置文件定义允许的命令和参数规则                             |
| 复杂命令解析        | 正确解析`"双引号"`、`'单引号'`、转义符`\`、反引号执行`` `cmd` ``等语法 |
| 反引号命令替换       | 支持执行`$()`或`` `cmd` ``内的子命令（需启用`ParseBacktick`）         |
| 多平台兼容          | 自动适配Linux（`/bin/sh`）和Windows（`cmd.exe`）的Shell执行环境       |
| 参数级细粒度控制     | 支持完全禁止参数、允许任意参数、限制特定参数等多种规则               |

---

## 安装与依赖
### 前置要求
- Go 1.23+（用于编译）
- 支持Linux/macOS/Windows系统

### 安装命令
```bash
# 从源码安装（需先克隆仓库）
go install github.com/YYRise/white-cmd@latest
```
---
## 配置白名单
```yaml
commands:
  # 允许所有参数的命令示例
  ls: ["*"]
  # 限制特定参数的命令示例
  apt-get: ["--yes", "--no-install-recommends"]
  # 仅允许无参数执行的命令示例
  date: []
```

## [TODO] 
- 实现环境变量参数